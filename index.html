<!DOCTYPE html>
<html>
<head>
   <title>GovHack 2018 - Big Orange Brain Entry</title>
   <script src="https://d3js.org/d3.v5.min.js"></script>
   <script>
      function govhack(div_id, data_file, title_label, x_axis_label, y_axis_label) {
         var width = 600, height = 470;
         var margin = { top: 70, right: 20, bottom: 50, left: 50 };
         var sub_width = width - margin.left - margin.right;
         var sub_height = height - margin.top - margin.bottom;

         var chart = d3.select("#" + div_id)
                          .append("svg")
                          .attr("width", width)
                          .attr("height", height);

         chart.append("g")
                 .attr("transform", "translate(" + width / 2 + ", " + margin.top / 3 * 1 + ")")
                 .append("text")
            .attr("id", div_id + "_title")
                 .attr("class", "annotation")
                 .attr("text-anchor", "middle")
            .text(title_label);

         chart.append("g")
                 .attr("transform", "translate(" + width / 8 + ", " + margin.top / 3 * 2  + ")")
                 .append("text")
            .attr("id", div_id + "_comment")
                 .attr("class", "annotation")
                 .attr("text-anchor", "left")
                 .text("Data value: Waiting for mouse over event");

         d3.csv(data_file).then(function(data) {
            var x = d3.scaleBand()
               .rangeRound([0, sub_width])
               .padding(0.1);

            var y = d3.scaleLinear()
               .rangeRound([sub_height, 0]);

            x.domain(data.map(function(d) { return d.Run; }));
            y.domain([0, d3.max(data, function(d) { return Number(d.Speed); })]);

            var g = chart.append("g").attr("transform", "translate(" + margin.left + ", " + margin.top + ")");

            g.append("g")
               .attr("transform", "translate(0," + sub_height + ")")
               .call(d3.axisBottom(x))
               .append("text")
               .attr("class", "label")
               .attr("transform", "translate(" + sub_width / 2 + ", " + margin.bottom / 3 * 2 + ")")
               .style("text-anchor", "middle")
               .text(x_axis_label);

            g.append("g")
               .call(d3.axisLeft(y))
               .append("text")
               .attr("class", "label")
               .attr("transform", "translate(" + -margin.left / 3 * 2 + ", " + sub_height / 2 + ") rotate(-90)")
               .attr("text-anchor", "middle")
               .text(y_axis_label);

            g.selectAll(".bar")
               .data(data)
               .enter()
               .append("rect")
               .on("mouseover", function(d) {
                  d3.select("#" + div_id + "_comment").text("Data value: " + Number(d.Speed));
               })
               .attr("class", "bar")
               .attr("x", function(d) { return x(d.Run); })
               .attr("width", x.bandwidth())
               .attr("y", function(d) { return sub_height; })
               .attr("height", function(d) { return 0; })
               .transition()
               .duration(1000)
               .delay(function(d, i) { return i * 100; })
               .attr("y", function(d) { return y(Number(d.Speed)); })
               .attr("height", function(d) { return sub_height - y(Number(d.Speed)); });
         });
      }
   </script>
   <style>

      body {
         background-color: black;
         color: white;
      }

      h1, h2, h3 {
         font-family: Verdana, Geneva, Tahoma, sans-serif;
      }

      #chart_01 svg {
         border: 1px solid white;
      }

      #chart_02 svg {
         border: 1px solid white;
      }

      .annotation {
         fill: white;
         font: bold 12px sans-serif;
      }

      .label {
         fill: white;
      }

      .bar {
         fill: darkgray;
      }

      .bar:hover {
         fill: darkorange;
      }
   </style>
</head>
<body onload="govhack('chart_01', 'brain.csv', 'My Plot1 Title', 'My X1 axis', 'My Y1 axis'); govhack('chart_02', 'cookie.csv', 'My Plot2 Title', 'My X2 axis', 'My Y2 axis');">
   <h1>Big Orange Brain</h1>
   <h2>Chart 01 - Sample</h2>
   <div id="chart_01"></div>
   <h2>Chart 02 - Sample</h2>
   <div id="chart_02"></div>
</body>
</html>
